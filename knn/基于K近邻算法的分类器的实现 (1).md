# 基于K近邻算法的分类器的实现

## 一、问题引入

海伦一直使用在线约会网站寻找适合自己的约会对象。她曾交往过三种类型的人：

- 不喜欢的人
- 一般喜欢的人
- 非常喜欢的人 

这些人包含以下三种特征

1. 每年获得的飞行常客里程数

2. 玩视频游戏所耗时间百分比
3. 每周消费的冰淇淋公升数

该网站现在需要尽可能向海伦推荐她喜欢的人，需要我们设计一个分类器，根据用户的以上三种特征，识别出是否该向海伦推荐。

## 二、需求概要分析

根据问题，我们可知，样本特征个数为3，样本标签为三类。现需要实现将一个待分类样本的三个特征值输入程序后，能够识别该样本的类别，并且将该类别输出。

## 三、程序结构设计说明

根据问题，可以知道程序大致流程如下。

![image-20230925150615280](F:\HuaweiMoveData\Users\lin\Desktop\typora-user-images\typora-user-images\image-20230925150615280.png)

其中输入数据应包含三个值，输出应为喜欢，一般，不喜欢，三个中的一个。

## 四、K近邻算法的一般流程

1. **数据准备：**这包括收集、清洗和预处理数据。**预处理可能包括归一化或标准化特征**，以确保所有特征在计算距离时具有相等的权重。

![image-20230925161432176](F:\HuaweiMoveData\Users\lin\Desktop\typora-user-images\typora-user-images\image-20230925161432176.png)

|      | 玩视频游戏所耗时间百分比 | 每年获得的飞行常客里程数 | 每周消费的冰淇淋的公升数 | 样本分类 |
| ---- | ------------------------ | ------------------------ | ------------------------ | -------- |
| 1    | 0.8                      | 400                      | 0.5                      | 1        |
| 2    | 12                       | 134000                   | 0.9                      | 3        |
| 3    | 0                        | 20000                    | 1.1                      | 2        |
| 4    | 67                       | 32000                    | 0.1                      | 2        |

我们很容易发现，当计算样本之间的距离时数字差值最大的属性对计算结果的影响最大，也就是说，每年获取的飞行常客里程数对于计算结果的影响将远远大于上表中其他两个特征-玩视频游戏所耗时间占比和每周消费冰淇淋公斤数的影响。而产生这种现象的唯一原因，仅仅是因为飞行常客里程数远大于其他特征值。但海伦认为这三种特征是同等重要的，因此作为三个等权重的特征之一，飞行常客里程数并不应该如此严重地影响到计算结果。

**在处理这种不同取值范围的特征值时，我们通常采用的方法是将数值归一化，如将取值范围处理为０到１或者-１到１之间。**下面的公式可以将任意取值范围的特征值转化为０到１区间内的值：
$$v_{new}=(v_{old}-v_{min})(v_{max}-v_{min})$$

2. **选择距离度量方法**：确定用于比较样本之间相似性的度量方法，常见的如欧几里得距离、曼哈顿距离等。

3. **确定K值：选择一个K值**，即在分类或回归时应考虑的邻居数量。这是一个超参数，可以通过交叉验证等方法来选择最优的K值。

4. **找到K个最近邻居**：对于每一个需要预测的未标记的样本：

- 计算该样本与训练集中所有样本的距离。
- 根据距离对它们进行排序。
- 选择距离最近的K个样本

5. **预测**：
   - 对于**分类任务**：查看K个最近邻居中最常见的类别，作为预测结果。例如，如果K=3，并且三个最近邻居的类别是[1, 2, 1]，那么预测结果就是类别1。
   - 对于**回归任务**：预测结果可以是K个最近邻居的平均值或加权平均值。

6. **评估：**使用适当的评价指标（如准确率、均方误差等）评估模型的性能。
7. **优化：**基于性能评估结果，可能需要返回并调整某些参数，如K值、距离度量方法等，以获得更好的性能。

## 五、算法实现

