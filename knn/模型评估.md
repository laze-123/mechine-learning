# 模型评估

- 模型评估是对训练好的模型性能进行评估, 模型评估是模型开发过程不可或缺的一部分。它有助于发现表达数据的最佳模型和所选模型将来工作的性能如何。

## 一、常见的分类模型评估指标

1. **准确率 (Accuracy)**

   - 描述：所有分类正确的样本数占总样本数的比例。
   - 公式：$Accuracy=\frac{Number\ of\  correct\ predictions}{Total\ number\ of\ predictions}$

2. **混淆矩阵 (Confusion Matrix)**

   - 描述：一个表格，显示模型对每个类别的预测数量和实际数量。

   - 主要组件：真正例 (True Positives, TP)，假正例 (False Positives, FP)，真反例 (True Negatives, TN)，假反例 (False Negatives, FN)。

     |                        | True Positive | True Negative |
     | :--------------------: | :-----------: | :-----------: |
     | **Predicted Positive** |      TP       |      FP       |
     | **Predicted Negative** |      FN       |      TN       |

3. **精确率（Precision）**

   - 描述：正确预测为正的样本数 (True Positives, TP) 与所有预测为正的样本数 (即True Positives + False Positives) 之比。
   - 公式：$Precision=\frac{True\ Positives}{True\ Positives + False\ Positives}$

4. **召回率 (Recall) **

   - 描述：正确预测为正的样本数 (True Positives, TP) 与所有实际为正的样本数 (即True Positives + False Negatives) 之比。
   - 公式：$Recall=\frac{True\ Positives}{True\ Positives + False\ Negatives}$

5. **F1分数 (F1 Score)**

   - 描述：精确率和召回率的调和平均值。F1的大小反映了模型的稳定性，数值越大说明越稳定。
   - 公式：$F1=2×\frac{Precision×Recall}{Precision+Recall}$

6. **ROC曲线 (Receiver Operating Characteristic Curve)**

   - 描述：在各种阈值设置下，真正例率 (TPR) 对假正例率 (FPR) 的曲线。**通过描绘两个指标之间的关系来展示分类器性能**

7. **PR曲线 (Precision-Recall Curve)**

   - 描述：在各种阈值设置下，精确率（Precision）和召回率（Recall）的曲线。**也是通过描绘两个指标之间的关系来展示分类器性能**

8. **AUC (Area Under the ROC Curve)**

   - 描述：ROC曲线下的面积，是用于评估分类器在不考虑决策边界的情况下的整体性能的指标。
   - 特点：**AUC的值介于0和1之间。一个完美的分类器的AUC值为1，而一个随机猜测的分类器的AUC值为0.5。**
   - 优点：AUC考虑了所有可能的决策边界，因此它为比较不同模型的性能提供了一种不依赖于特定阈值的方法。

9. **AP (Average Precision)**

   - 描述：PR曲线下的面积，用于评估分类器的整体精确率。
   - 特点：**AP的值介于0和1之间。完美分类器的AP值为1，随机分类器的AP值等于数据中正类的比例。**
   - 优点：与AUC类似，AP为分类器提供了一个整体的性能度量，不依赖于特定的阈值。但是，与AUC不同，AP特别适用于正负样本不平衡的情况。

## 二、ROC曲线与PR曲线的差异

1. **坐标轴**
   - ROC曲线的x轴是FPR，y轴是TPR。
   - PR曲线的x轴是Recall（或TPR），y轴是Precision。
2. **应用场景**
   - 在正负样本均衡的情况下，ROC曲线是一个很好的性能度量。
   - 在正负样本不均衡的情况下，PR曲线往往更有信息量。
3. **整体性能指标**
   - ROC曲线使用AUC（曲线下的面积）。
   - PR曲线使用AP（Average Precision，曲线下的面积）。

总之，AUC是ROC曲线下的面积，它考虑了分类器在所有可能的决策边界下的性能。AP是PR曲线下的面积，它特别适用于正负样本不平衡的情况，提供了对分类器整体精确率的评估。**选择AUC还是AP取决于具体问题和数据集的性质。在正负样本严重不平衡的情况下，AP可能会提供更真实、更有信息量的评估。**

## 三、画ROC曲线和PR曲线

